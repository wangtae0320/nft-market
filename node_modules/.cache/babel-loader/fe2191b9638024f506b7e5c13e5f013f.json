{"ast":null,"code":"var _jsxFileName = \"/Users/mina/Desktop/gradient_animated_site/src/store/CollectionProvider.js\",\n    _s = $RefreshSig$();\n\nimport { useReducer } from 'react';\nimport CollectionContext from './collection-context';\nimport { ethers } from 'ethers';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst defaultCollectionState = {\n  contract: null,\n  totalSupply: null // collection: [],\n  // nftIsLoading: true,\n  // userFunds: null\n\n};\n\nconst PriceNFTPeducer = (state, action) => {\n  if (action.type === 'CONTRACT') {\n    return {\n      contract: action.contract,\n      totalSupply: state.totalSupply,\n      collection: state.collection,\n      nftIsLoading: state.nftIsLoading\n    };\n  }\n\n  if (action.type === 'LOADSUPPLY') {\n    return {\n      contract: state.contract,\n      totalSupply: action.totalSupply,\n      collection: state.collection,\n      nftIsLoading: state.nftIsLoading\n    };\n  }\n\n  if (action.type === 'LOADCOLLECTION') {\n    return {\n      contract: state.contract,\n      totalSupply: state.totalSupply,\n      collection: action.collection,\n      nftIsLoading: state.nftIsLoading\n    };\n  }\n\n  if (action.type === 'LOADING') {\n    return {\n      contract: state.contract,\n      totalSupply: state.totalSupply,\n      collection: state.collection,\n      nftIsLoading: action.loading\n    };\n  } // if(action.type === 'LOADFUNDS') {\n  //   return {\n  //     contract: state.contract,\n  //     offerCount: state.offerCount,\n  //     offers: state.offers,\n  //     userFunds: action.userFunds,\n  //     mktIsLoading: state.mktIsLoading\n  //   };\n  // }\n\n\n  return defaultCollectionState;\n};\n\n_c = PriceNFTPeducer;\n\nconst CollectionProvider = props => {\n  _s();\n\n  const [CollectionState, dispatchCollectionAction] = useReducer(PriceNFTPeducer, defaultCollectionState);\n\n  const loadContractHandler = (address, abi, provider) => {\n    const contract = address ? new ethers.Contract(address, abi, provider) : '';\n    console.log('Funding Contract is load!!', address);\n    dispatchCollectionAction({\n      type: 'CONTRACT',\n      contract: contract\n    });\n    return contract;\n  };\n\n  const loadTotalSupplyHandler = async contract => {\n    console.log('loadTotalSupplyHandler is load222!!');\n    const totalSupply = await contract.totalSupply();\n    console.log('loadTotalSupplyHandler is load222!!' + totalSupply);\n    dispatchCollectionAction({\n      type: 'LOADSUPPLY',\n      totalSupply: totalSupply\n    });\n    return totalSupply;\n  };\n\n  const loadCollectionHandler = async (contract, totalSupply) => {\n    let collection = [];\n    console.log('loadCollectionHandler is load!!');\n\n    for (let i = 0; i < totalSupply; i++) {\n      const hash = await contract._tokenURIs(i);\n      console.log(hash);\n\n      try {\n        const response = await fetch(`https://ipfs.io/ipfs/${hash}`);\n        console.log(response);\n\n        if (!response.ok) {\n          throw new Error('Something went wrong');\n        }\n\n        const metadata = await response.json(); // const owner = await contract.methods.ownerOf(i).call()\n        // const price = await contract.methods.prices(i).call()\n        // const fundingPot = await contract.methods.fundingPot(i).call()\n        // console.log('price ', price)\n        // console.log('fundingPot ', fundingPot)\n        // contract에서 데이터를 가져옴\n\n        collection = [{\n          id: i,\n          title: metadata.properties.name.description,\n          img: metadata.properties.image.description // owner: owner,\n          // price: price,\n          // fundingPot: fundingPot,\n\n        }, ...collection];\n      } catch {\n        console.error('Something went wrong');\n      }\n    }\n\n    console.log('collection:', collection);\n    dispatchCollectionAction({\n      type: 'LOADCOLLECTION',\n      collection: collection\n    });\n  }; // const loadUserFundsHandler = async(contract, account) => {\n  //   const userFunds = await contract.methods.userFunds(account).call();\n  //   dispatchCollectionAction({type: 'LOADFUNDS', userFunds: userFunds});\n  //   return userFunds;\n  // };\n\n\n  const setNftIsLoadingHandler = loading => {\n    dispatchCollectionAction({\n      type: 'LOADING',\n      loading: loading\n    });\n  };\n\n  const collectionContext = {\n    contract: CollectionState.contract,\n    totalSupply: CollectionState.totalSupply,\n    collection: CollectionState.collection,\n    nftIsLoading: CollectionState.nftIsLoading,\n    loadContract: loadContractHandler,\n    loadTotalSupply: loadTotalSupplyHandler,\n    loadCollection: loadCollectionHandler,\n    setNftIsLoading: setNftIsLoadingHandler\n  };\n  return /*#__PURE__*/_jsxDEV(CollectionContext.Provider, {\n    value: collectionContext,\n    children: props.children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 143,\n    columnNumber: 5\n  }, this);\n};\n\n_s(CollectionProvider, \"ZbRmD8kAHPzijQQn9Hqowc3SWuI=\");\n\n_c2 = CollectionProvider;\nexport default CollectionProvider;\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"PriceNFTPeducer\");\n$RefreshReg$(_c2, \"CollectionProvider\");","map":{"version":3,"sources":["/Users/mina/Desktop/gradient_animated_site/src/store/CollectionProvider.js"],"names":["useReducer","CollectionContext","ethers","defaultCollectionState","contract","totalSupply","PriceNFTPeducer","state","action","type","collection","nftIsLoading","loading","CollectionProvider","props","CollectionState","dispatchCollectionAction","loadContractHandler","address","abi","provider","Contract","console","log","loadTotalSupplyHandler","loadCollectionHandler","i","hash","_tokenURIs","response","fetch","ok","Error","metadata","json","id","title","properties","name","description","img","image","error","setNftIsLoadingHandler","collectionContext","loadContract","loadTotalSupply","loadCollection","setNftIsLoading","children"],"mappings":"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","sourcesContent":["import { useReducer } from 'react'\n\nimport CollectionContext from './collection-context'\nimport { ethers } from 'ethers'\n\nconst defaultCollectionState = {\n  contract: null,\n  totalSupply: null,\n  // collection: [],\n  // nftIsLoading: true,\n  // userFunds: null\n}\n\nconst PriceNFTPeducer = (state, action) => {\n  if (action.type === 'CONTRACT') {\n    return {\n      contract: action.contract,\n      totalSupply: state.totalSupply,\n      collection: state.collection,\n      nftIsLoading: state.nftIsLoading,\n    }\n  }\n\n  if (action.type === 'LOADSUPPLY') {\n    return {\n      contract: state.contract,\n      totalSupply: action.totalSupply,\n      collection: state.collection,\n      nftIsLoading: state.nftIsLoading,\n    }\n  }\n\n  if (action.type === 'LOADCOLLECTION') {\n    return {\n      contract: state.contract,\n      totalSupply: state.totalSupply,\n      collection: action.collection,\n      nftIsLoading: state.nftIsLoading,\n    }\n  }\n  if (action.type === 'LOADING') {\n    return {\n      contract: state.contract,\n      totalSupply: state.totalSupply,\n      collection: state.collection,\n      nftIsLoading: action.loading,\n    }\n  }\n  // if(action.type === 'LOADFUNDS') {\n  //   return {\n  //     contract: state.contract,\n  //     offerCount: state.offerCount,\n  //     offers: state.offers,\n  //     userFunds: action.userFunds,\n  //     mktIsLoading: state.mktIsLoading\n  //   };\n  // }\n\n  return defaultCollectionState\n}\n\nconst CollectionProvider = (props) => {\n  const [CollectionState, dispatchCollectionAction] = useReducer(\n    PriceNFTPeducer,\n    defaultCollectionState,\n  )\n\n  const loadContractHandler = (address, abi, provider) => {\n    const contract = address ? new ethers.Contract(address, abi, provider) : ''\n    console.log('Funding Contract is load!!', address)\n    dispatchCollectionAction({ type: 'CONTRACT', contract: contract })\n    return contract\n  }\n\n  const loadTotalSupplyHandler = async (contract) => {\n    console.log('loadTotalSupplyHandler is load222!!')\n    const totalSupply = await contract.totalSupply()\n    console.log('loadTotalSupplyHandler is load222!!' + totalSupply)\n    dispatchCollectionAction({ type: 'LOADSUPPLY', totalSupply: totalSupply })\n    return totalSupply\n  }\n\n  const loadCollectionHandler = async (contract, totalSupply) => {\n    let collection = []\n    console.log('loadCollectionHandler is load!!')\n    for (let i = 0; i < totalSupply; i++) {\n      const hash = await contract._tokenURIs(i)\n      console.log(hash)\n      try {\n        const response = await fetch(`https://ipfs.io/ipfs/${hash}`)\n        console.log(response)\n        if (!response.ok) {\n          throw new Error('Something went wrong')\n        }\n\n        const metadata = await response.json()\n        // const owner = await contract.methods.ownerOf(i).call()\n        // const price = await contract.methods.prices(i).call()\n        // const fundingPot = await contract.methods.fundingPot(i).call()\n        // console.log('price ', price)\n        // console.log('fundingPot ', fundingPot)\n        // contract에서 데이터를 가져옴\n        collection = [\n          {\n            id: i,\n            title: metadata.properties.name.description,\n            img: metadata.properties.image.description,\n            // owner: owner,\n            // price: price,\n            // fundingPot: fundingPot,\n          },\n          ...collection,\n        ]\n      } catch {\n        console.error('Something went wrong')\n      }\n    }\n    console.log('collection:', collection)\n    dispatchCollectionAction({ type: 'LOADCOLLECTION', collection: collection })\n  }\n\n  // const loadUserFundsHandler = async(contract, account) => {\n  //   const userFunds = await contract.methods.userFunds(account).call();\n  //   dispatchCollectionAction({type: 'LOADFUNDS', userFunds: userFunds});\n  //   return userFunds;\n  // };\n\n  const setNftIsLoadingHandler = (loading) => {\n    dispatchCollectionAction({ type: 'LOADING', loading: loading })\n  }\n\n  const collectionContext = {\n    contract: CollectionState.contract,\n    totalSupply: CollectionState.totalSupply,\n    collection: CollectionState.collection,\n    nftIsLoading: CollectionState.nftIsLoading,\n    loadContract: loadContractHandler,\n    loadTotalSupply: loadTotalSupplyHandler,\n    loadCollection: loadCollectionHandler,\n    setNftIsLoading: setNftIsLoadingHandler,\n  }\n  return (\n    <CollectionContext.Provider value={collectionContext}>\n      {props.children}\n    </CollectionContext.Provider>\n  )\n}\n\nexport default CollectionProvider\n"]},"metadata":{},"sourceType":"module"}